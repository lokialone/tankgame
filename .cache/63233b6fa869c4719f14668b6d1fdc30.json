{"dependencies":[{"name":"./tank.js","loc":{"line":1,"column":17}},{"name":"./util.js","loc":{"line":2,"column":17}},{"name":"./bullet.js","loc":{"line":3,"column":19}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _tank = require(\"./tank.js\");\n\nvar _tank2 = _interopRequireDefault(_tank);\n\nvar _util = require(\"./util.js\");\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _bullet = require(\"./bullet.js\");\n\nvar _bullet2 = _interopRequireDefault(_bullet);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass NpcTank extends _tank2.default {\n  constructor(min, x_max, y_max) {\n    super();\n    this.edge_min = min;\n    this.edge_x_max = x_max;\n    this.edge_y_max = y_max;\n    this.speed = 1;\n    this.bullet = '';\n    this.bulletsDistance = 60;\n    this.bulletsCount = 5;\n    this.color = 'hsba(160, 100%, 50%, 0.5)';\n  }\n\n  autoMove(p) {\n    this.render(p);\n    this.autoUpdate(p);\n  }\n  autoUpdate(p) {\n    this.goForward();\n    if (this.isEdges()) {\n      this.findDirection();\n    }\n  }\n  setLocationAndDirection(x, y, direction) {\n    this.setLocation(x, y);\n    this.setDirection(direction);\n  }\n\n  getRandomDirection() {\n    var dirs = [];\n    for (var key in Direction) {\n      dirs.push(key);\n    }\n    var i = Math.floor(_util2.default.randomRange(0, dirs.length));\n    return Direction[dirs[i]];\n  }\n\n  createRandom(x, y) {\n    var dir = this.getRandomDirection();\n    this.setLocationAndDirection(x, y, dir);\n  }\n\n  isEdges() {\n    if (this.x <= this.edge_min || this.x >= this.edge_x_max || this.y <= this.edge_min || this.y >= this.edge_y_max) {\n      return true;\n    }\n    return false;\n  }\n\n  render(p) {\n    // render bullets\n    for (var i = 0; i < this.bullets.length; i++) {\n      this.bullets[i].render(p);\n      this.bullets[i].update(p);\n    }\n\n    p.push();\n    // 坦克的body\n\n    p.fill(p.color(this.color));\n\n    p.translate(this.x, this.y);\n    p.rotate(this.direction);\n\n    p.rect(-this.tankWidth / 2, -this.tankHeight / 2, this.tankWidth, this.tankHeight, this.borderRadius);\n    //坦克的炮台\n\n    p.rect(-this.gunturretWidth / 2, -this.gunturretHeight / 2, this.gunturretWidth, this.gunturretHeight, this.borderRadius);\n    // 坦克的大炮\n    p.rect(-this.cannonDiameter / 2, -this.gunturretHeight / 2 - this.cannonHeight, this.cannonDiameter, this.cannonHeight);\n    p.pop();\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  goForward(rate = 1) {\n    switch (this.direction) {\n      case Direction.UP:\n        this.y -= this.speed * rate;\n        break;\n      case Direction.DOWN:\n        this.y += this.speed * rate;\n        break;\n      case Direction.LEFT:\n        this.x -= this.speed * rate;\n        break;\n      case Direction.RIGHT:\n        this.x += this.speed * rate;\n        break;\n      default:\n        this.y += this.speed * rate;\n    }\n  }\n\n  findDirection() {\n    for (var dir in Direction) {\n      if (this.direction === Direction[dir]) continue;\n      this.setDirection(Direction[dir]);\n      this.goForward();\n      if (!this.isEdges()) {\n        this.goForward(-1);\n        break;\n      }\n      this.goForward(-1);\n    }\n  }\n\n  changeDirctionWhenCollision() {\n    this.setDirection(this.direction + Math.PI);\n  }\n\n  initBullets(dir) {\n    this.bullet = new _bullet2.default(this.x, this.y, this.direction);\n  }\n\n  bulletsRender(p) {\n    this.bullet.render(p);\n    if (this.bullet.x <= 0 || this.bullet.x >= this.edge_x_max || this.bullet.y >= this.edge_y_max || this.bullet.y <= 0) {\n      this.bullet.setLocation(this.x, this.y);\n      this.bullet.setDirection(this.direction);\n    }\n    this.bullet.update();\n  }\n}\n\nexports.default = NpcTank;"},"hash":"3f047ecc5622e6ce5cdac0326a25ed6e"}